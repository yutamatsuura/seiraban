<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ é€†è§£æ - æ­£ã—ã„ãƒ­ã‚¸ãƒƒã‚¯æŠ½å‡º</title>
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .input-group input, .input-group select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .btn {
            background: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }

        .btn:hover {
            background: #0056b3;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .result-panel {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
        }

        .iframe-container {
            width: 100%;
            height: 600px;
            border: 2px solid #007bff;
            border-radius: 8px;
            overflow: hidden;
        }

        .analysis-result {
            background: #e7f3ff;
            border: 1px solid #b6d7ff;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ é€†è§£æ - æ­£ã—ã„ãƒ­ã‚¸ãƒƒã‚¯æŠ½å‡º</h1>

        <div class="section">
            <h2>ğŸ“ ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¨­å®š</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                <div class="input-group">
                    <label for="testYear">ç”Ÿå¹´</label>
                    <input type="number" id="testYear" value="1982" min="1900" max="2100">
                </div>
                <div class="input-group">
                    <label for="testMonth">ç”Ÿæœˆ</label>
                    <input type="number" id="testMonth" value="10" min="1" max="12">
                </div>
                <div class="input-group">
                    <label for="testDay">ç”Ÿæ—¥</label>
                    <input type="number" id="testDay" value="12" min="1" max="31">
                </div>
                <div class="input-group">
                    <label for="testGender">æ€§åˆ¥</label>
                    <select id="testGender">
                        <option value="1">ç”·æ€§</option>
                        <option value="0">å¥³æ€§</option>
                    </select>
                </div>
            </div>

            <button class="btn" onclick="analyzeExistingSystem()">
                ğŸ”¬ æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã‚’è§£æ
            </button>
            <button class="btn" onclick="extractLogicFromHTML()">
                ğŸ§® HTMLã‹ã‚‰æ•°å€¤ã‚’æŠ½å‡º
            </button>
            <button class="btn" onclick="generateCorrectedLogic()">
                âœ… æ­£ã—ã„ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç”Ÿæˆ
            </button>
        </div>

        <div class="comparison-grid">
            <div class="result-panel">
                <h3>ğŸŒ æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ï¼ˆæ­£è§£ï¼‰</h3>
                <iframe id="existingSystemFrame"
                        class="iframe-container"
                        src="about:blank"
                        title="æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ">
                </iframe>
            </div>

            <div class="result-panel">
                <h3>ğŸ“Š è§£æçµæœ</h3>
                <div id="analysisResults">
                    <p>ã€Œæ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã‚’è§£æã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ” æŠ½å‡ºã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿</h2>
            <div id="extractedData" class="analysis-result">
                ã¾ã ãƒ‡ãƒ¼ã‚¿ãŒæŠ½å‡ºã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
            </div>
        </div>

        <div class="section">
            <h2>âš¡ ä¿®æ­£ã•ã‚ŒãŸãƒ­ã‚¸ãƒƒã‚¯</h2>
            <div id="correctedLogic" class="analysis-result">
                è§£æå®Œäº†å¾Œã«æ­£ã—ã„ãƒ­ã‚¸ãƒƒã‚¯ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
            </div>
        </div>
    </div>

    <script>
        let extractedSystemData = null;

        function buildExistingSystemUrl() {
            const year = document.getElementById('testYear').value;
            const month = document.getElementById('testMonth').value;
            const day = document.getElementById('testDay').value;
            const gender = document.getElementById('testGender').value;

            const baseUrl = 'https://kigaku-navi.com/qsei/ban_kipou.php';
            const params = new URLSearchParams({
                'birth_y': year,
                'birth_m': month.padStart(2, '0'),
                'birth_d': day.padStart(2, '0'),
                'sex': gender,
                'action': 'calc'
            });

            return `${baseUrl}?${params.toString()}`;
        }

        function analyzeExistingSystem() {
            const url = buildExistingSystemUrl();
            console.log('æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ è§£æé–‹å§‹:', url);

            // iframeã§æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã‚’è¡¨ç¤º
            const iframe = document.getElementById('existingSystemFrame');
            iframe.src = url;

            // è§£æçµæœã‚’æ›´æ–°
            document.getElementById('analysisResults').innerHTML = `
                <div class="analysis-result">
                    <strong>ğŸ“ è§£æä¸­...</strong><br>
                    URL: ${url}<br><br>
                    <strong>ğŸ“‹ æ‰‹å‹•ç¢ºèªé …ç›®:</strong><br>
                    1. æœ¬å‘½æ˜Ÿï¼ˆå¹´æ˜Ÿï¼‰ã®å€¤<br>
                    2. æœˆå‘½æ˜Ÿã®å€¤<br>
                    3. å¹´ç›¤ã®ä¸­å¤®å€¤<br>
                    4. æœˆç›¤ã®ä¸­å¤®å€¤<br>
                    5. æ—¥ç›¤ã®ä¸­å¤®å€¤<br>
                    6. å„æ–¹ä½ã®ä¹æ˜Ÿé…ç½®<br>
                    7. å‰å‡¶åˆ¤å®šçµæœ<br><br>
                    <em>å³å´ã®iframeã§å®Ÿéš›ã®çµæœã‚’ç¢ºèªã—ã¦ãã ã•ã„</em>
                </div>
            `;

            // iframeèª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«ã•ã‚‰ãªã‚‹è§£æã‚’å®Ÿè¡Œ
            iframe.onload = function() {
                setTimeout(() => {
                    try {
                        // Same-origin policyã®ãŸã‚ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã¯ã§ããªã„ãŒã€
                        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å‹•ã§ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º
                        showManualExtractionGuide();
                    } catch (error) {
                        console.log('Same-origin policy ã«ã‚ˆã‚Šè‡ªå‹•æŠ½å‡ºã¯ã§ãã¾ã›ã‚“');
                        showManualExtractionGuide();
                    }
                }, 2000);
            };
        }

        function showManualExtractionGuide() {
            document.getElementById('analysisResults').innerHTML += `
                <div class="analysis-result success">
                    <strong>âœ… æ‰‹å‹•æŠ½å‡ºã‚¬ã‚¤ãƒ‰</strong><br><br>

                    <strong>1. åŸºæœ¬æƒ…å ±æŠ½å‡º:</strong><br>
                    - æœ¬å‘½æ˜Ÿ: [å³å´ã§ç¢ºèª] (æœŸå¾…å€¤: ä¹ç´«ç«æ˜Ÿ)<br>
                    - æœˆå‘½æ˜Ÿ: [å³å´ã§ç¢ºèª] (æœŸå¾…å€¤: å…­ç™½é‡‘æ˜Ÿ)<br><br>

                    <strong>2. æ–¹ä½ç›¤ä¸­å¤®å€¤:</strong><br>
                    - å¹´ç›¤ä¸­å¤®: [å³å´ã§ç¢ºèª]<br>
                    - æœˆç›¤ä¸­å¤®: [å³å´ã§ç¢ºèª]<br>
                    - æ—¥ç›¤ä¸­å¤®: [å³å´ã§ç¢ºèª] (æœŸå¾…å€¤: 7)<br><br>

                    <strong>3. åŸºç›¤é…ç½®:</strong><br>
                    å„æ–¹ä½ï¼ˆåŒ—ãƒ»åŒ—æ±ãƒ»æ±ãƒ»å—æ±ãƒ»å—ãƒ»å—è¥¿ãƒ»è¥¿ãƒ»åŒ—è¥¿ï¼‰ã®ä¹æ˜Ÿã‚’ç¢ºèª<br><br>

                    <strong>4. å‰å‡¶åˆ¤å®š:</strong><br>
                    - æœ€å¤§å‰æ–¹ã®æ–¹ä½<br>
                    - äº”é»„æ®ºãƒ»æš—å‰£æ®ºã®ä½ç½®<br>
                    - æœ¬å‘½æ®ºãƒ»æœˆå‘½æ®ºã®ä½ç½®<br>
                    - æœˆå‘½çš„æ®ºãƒ»æœ¬å‘½çš„æ®ºã®ä½ç½®<br><br>

                    ç¢ºèªã§ããŸã‚‰ã€ŒHTMLã‹ã‚‰æ•°å€¤ã‚’æŠ½å‡ºã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚
                </div>
            `;
        }

        function extractLogicFromHTML() {
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å‹•ã§å…¥åŠ›ã§ãã‚‹ãƒ•ã‚©ãƒ¼ãƒ 
            document.getElementById('extractedData').innerHTML = `
                <h4>ğŸ“ æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰èª­ã¿å–ã£ãŸå€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:</h4>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                    <div>
                        <label><strong>æœ¬å‘½æ˜Ÿï¼ˆæ•°å€¤ï¼‰:</strong></label>
                        <input type="number" id="actualYearQsei" placeholder="ä¾‹: 9" min="1" max="9">
                    </div>
                    <div>
                        <label><strong>æœˆå‘½æ˜Ÿï¼ˆæ•°å€¤ï¼‰:</strong></label>
                        <input type="number" id="actualMonthQsei" placeholder="ä¾‹: 6" min="1" max="9">
                    </div>
                    <div>
                        <label><strong>ç¾åœ¨å¹´ç›¤ä¸­å¤®:</strong></label>
                        <input type="number" id="actualYearCenter" placeholder="ä¾‹: 3" min="1" max="9">
                    </div>
                    <div>
                        <label><strong>ç¾åœ¨æœˆç›¤ä¸­å¤®:</strong></label>
                        <input type="number" id="actualMonthCenter" placeholder="ä¾‹: 6" min="1" max="9">
                    </div>
                    <div>
                        <label><strong>ç¾åœ¨æ—¥ç›¤ä¸­å¤®:</strong></label>
                        <input type="number" id="actualDayCenter" placeholder="ä¾‹: 7" min="1" max="9">
                    </div>
                </div>

                <h4>ğŸ“ å¹´ç›¤åŸºç›¤é…ç½®ï¼ˆåŒ—ã‹ã‚‰æ™‚è¨ˆå›ã‚Šï¼‰:</h4>
                <div style="display: grid; grid-template-columns: repeat(8, 1fr); gap: 10px; margin: 20px 0;">
                    <input type="number" id="yearKiban0" placeholder="åŒ—" min="1" max="9">
                    <input type="number" id="yearKiban1" placeholder="åŒ—æ±" min="1" max="9">
                    <input type="number" id="yearKiban2" placeholder="æ±" min="1" max="9">
                    <input type="number" id="yearKiban3" placeholder="å—æ±" min="1" max="9">
                    <input type="number" id="yearKiban4" placeholder="å—" min="1" max="9">
                    <input type="number" id="yearKiban5" placeholder="å—è¥¿" min="1" max="9">
                    <input type="number" id="yearKiban6" placeholder="è¥¿" min="1" max="9">
                    <input type="number" id="yearKiban7" placeholder="åŒ—è¥¿" min="1" max="9">
                </div>

                <h4>ğŸ“ æœˆç›¤åŸºç›¤é…ç½®ï¼ˆåŒ—ã‹ã‚‰æ™‚è¨ˆå›ã‚Šï¼‰:</h4>
                <div style="display: grid; grid-template-columns: repeat(8, 1fr); gap: 10px; margin: 20px 0;">
                    <input type="number" id="monthKiban0" placeholder="åŒ—" min="1" max="9">
                    <input type="number" id="monthKiban1" placeholder="åŒ—æ±" min="1" max="9">
                    <input type="number" id="monthKiban2" placeholder="æ±" min="1" max="9">
                    <input type="number" id="monthKiban3" placeholder="å—æ±" min="1" max="9">
                    <input type="number" id="monthKiban4" placeholder="å—" min="1" max="9">
                    <input type="number" id="monthKiban5" placeholder="å—è¥¿" min="1" max="9">
                    <input type="number" id="monthKiban6" placeholder="è¥¿" min="1" max="9">
                    <input type="number" id="monthKiban7" placeholder="åŒ—è¥¿" min="1" max="9">
                </div>

                <button class="btn" onclick="processExtractedData()">
                    âœ… å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†
                </button>
            `;
        }

        function processExtractedData() {
            // å…¥åŠ›ã•ã‚ŒãŸå€¤ã‚’åé›†
            extractedSystemData = {
                birthInfo: {
                    year: parseInt(document.getElementById('testYear').value),
                    month: parseInt(document.getElementById('testMonth').value),
                    day: parseInt(document.getElementById('testDay').value),
                    yearQsei: parseInt(document.getElementById('actualYearQsei').value),
                    monthQsei: parseInt(document.getElementById('actualMonthQsei').value)
                },
                currentInfo: {
                    year: 2025,
                    month: 9,
                    day: 24,
                    yearCenter: parseInt(document.getElementById('actualYearCenter').value),
                    monthCenter: parseInt(document.getElementById('actualMonthCenter').value),
                    dayCenter: parseInt(document.getElementById('actualDayCenter').value)
                },
                yearKiban: [],
                monthKiban: []
            };

            // åŸºç›¤é…ç½®ã‚’åé›†
            for (let i = 0; i < 8; i++) {
                extractedSystemData.yearKiban.push(parseInt(document.getElementById(`yearKiban${i}`).value) || 0);
                extractedSystemData.monthKiban.push(parseInt(document.getElementById(`monthKiban${i}`).value) || 0);
            }

            console.log('æŠ½å‡ºãƒ‡ãƒ¼ã‚¿:', extractedSystemData);

            document.getElementById('extractedData').innerHTML += `
                <div class="analysis-result success">
                    <strong>âœ… ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºå®Œäº†</strong><br>
                    <pre>${JSON.stringify(extractedSystemData, null, 2)}</pre>
                </div>
            `;
        }

        function generateCorrectedLogic() {
            if (!extractedSystemData) {
                alert('ã¾ãšæ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            // æŠ½å‡ºã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«æ­£ã—ã„ãƒ­ã‚¸ãƒƒã‚¯ã‚’é€†ç®—
            const correctedLogic = reverseEngineerLogic(extractedSystemData);

            document.getElementById('correctedLogic').innerHTML = `
                <h4>ğŸ¯ é€†è§£æã•ã‚ŒãŸæ­£ã—ã„ãƒ­ã‚¸ãƒƒã‚¯:</h4>
                <pre>${correctedLogic}</pre>

                <h4>ğŸ“ ä¿®æ­£ãŒå¿…è¦ãªãƒã‚¤ãƒ³ãƒˆ:</h4>
                <ul>
                    <li><strong>å¹´æ˜Ÿè¨ˆç®—:</strong> æ—¢å­˜ã®è¨ˆç®—å¼ã‚’ç¢ºèª</li>
                    <li><strong>æœˆæ˜Ÿè¨ˆç®—:</strong> MONTH_TABLEã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç¢ºèª</li>
                    <li><strong>æ—¥æ˜Ÿè¨ˆç®—:</strong> QseiDayCreaterã®ãƒ­ã‚¸ãƒƒã‚¯ç¢ºèª</li>
                    <li><strong>åŸºç›¤é…ç½®:</strong> QSEI_DATAã® kiban8 é…åˆ—ç¢ºèª</li>
                    <li><strong>æ–¹ä½é †åº:</strong> POINT_RADIANS ã®é †åºç¢ºèª</li>
                </ul>

                <button class="btn" onclick="generateCorrectedFile()">
                    ğŸ“„ ä¿®æ­£ç‰ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ
                </button>
            `;
        }

        function reverseEngineerLogic(data) {
            return `
// é€†è§£æçµæœ - ${new Date().toISOString()}

// ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹: ${data.birthInfo.year}å¹´${data.birthInfo.month}æœˆ${data.birthInfo.day}æ—¥
// æœŸå¾…ã•ã‚Œã‚‹çµæœ:
const EXPECTED_RESULTS = {
    birth: {
        yearQsei: ${data.birthInfo.yearQsei}, // æœ¬å‘½æ˜Ÿ
        monthQsei: ${data.birthInfo.monthQsei}  // æœˆå‘½æ˜Ÿ
    },
    current: {
        yearCenter: ${data.currentInfo.yearCenter},   // å¹´ç›¤ä¸­å¤®
        monthCenter: ${data.currentInfo.monthCenter}, // æœˆç›¤ä¸­å¤®
        dayCenter: ${data.currentInfo.dayCenter}      // æ—¥ç›¤ä¸­å¤®
    },
    kiban: {
        year: [${data.yearKiban.join(', ')}],   // å¹´ç›¤åŸºç›¤
        month: [${data.monthKiban.join(', ')}]  // æœˆç›¤åŸºç›¤
    }
};

// ä¿®æ­£ãŒå¿…è¦ãªè¨ˆç®—å¼:
// 1. å¹´æ˜Ÿè¨ˆç®—å¼ã®è¦‹ç›´ã—
// 2. æœˆæ˜Ÿè¨ˆç®—ã®MONTH_TABLEã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
// 3. æ—¥æ˜Ÿè¨ˆç®—ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
// 4. åŸºç›¤é…ç½®ã®é †åºãƒ»å›è»¢
            `;
        }

        function generateCorrectedFile() {
            if (!extractedSystemData) return;

            // æ–°ã—ã„HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆï¼ˆåˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§è¡¨ç¤ºï¼‰
            const correctedHTML = generateCorrectedHoibanHTML(extractedSystemData);

            const newWindow = window.open('', '_blank');
            newWindow.document.write(correctedHTML);
            newWindow.document.close();
        }

        function generateCorrectedHoibanHTML(data) {
            return `
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ä¿®æ­£ç‰ˆæ–¹ä½ç›¤ - æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ æº–æ‹ </title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* å‰å›ã¨åŒã˜CSS */
        body { font-family: 'Noto Sans JP', sans-serif; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; }
        /* ... ä»–ã®CSSã‚‚åŒæ§˜ ... */
    </style>
</head>
<body>
    <div class="container">
        <h1>ä¿®æ­£ç‰ˆä¹æ˜Ÿæ°—å­¦æ–¹ä½ç›¤ï¼ˆæ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ æº–æ‹ ï¼‰</h1>

        <div class="meta-info">
            <div><strong>æ¤œè¨¼çµæœ:</strong></div>
            <div>æœ¬å‘½æ˜Ÿ: ${data.birthInfo.yearQsei} (æœŸå¾…å€¤ã¨ä¸€è‡´: ${data.birthInfo.yearQsei === 9 ? 'âœ…' : 'âŒ'})</div>
            <div>æœˆå‘½æ˜Ÿ: ${data.birthInfo.monthQsei} (æœŸå¾…å€¤ã¨ä¸€è‡´: ${data.birthInfo.monthQsei === 6 ? 'âœ…' : 'âŒ'})</div>
            <div>æ—¥ç›¤ä¸­å¤®: ${data.currentInfo.dayCenter} (æœŸå¾…å€¤ã¨ä¸€è‡´: ${data.currentInfo.dayCenter === 7 ? 'âœ…' : 'âŒ'})</div>
        </div>

        <div class="hoiban-row">
            <div class="hoiban-section">
                <div class="ban-title">å¹´ç›¤ï¼ˆä¿®æ­£ç‰ˆï¼‰</div>
                <svg id="correctedYearBan" width="420" height="420"></svg>
            </div>
            <div class="hoiban-section">
                <div class="ban-title">æœˆç›¤ï¼ˆä¿®æ­£ç‰ˆï¼‰</div>
                <svg id="correctedMonthBan" width="420" height="420"></svg>
            </div>
        </div>

        <div class="debug-info">
            <h3>ğŸ” æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿:</h3>
            <pre>${JSON.stringify(data, null, 2)}</pre>
        </div>
    </div>

    <script>
        // æŠ½å‡ºã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ãŸæ­£ç¢ºãªå®Ÿè£…
        const CORRECTED_DATA = ${JSON.stringify(data, null, 2)};

        // TODO: æŠ½å‡ºã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«æ­£ç¢ºãªæç”»ã‚’å®Ÿè£…
        console.log('ä¿®æ­£ç‰ˆãƒ‡ãƒ¼ã‚¿:', CORRECTED_DATA);

        // å®Ÿéš›ã®æç”»ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã“ã“ã«å®Ÿè£…
        // ï¼ˆæŠ½å‡ºã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãï¼‰
    </script>
</body>
</html>
            `;
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è‡ªå‹•å®Ÿè¡Œ
        window.onload = function() {
            setTimeout(() => {
                analyzeExistingSystem();
            }, 1000);
        };
    </script>
</body>
</html>